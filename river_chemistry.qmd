# River water chemistry

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

River water chemistry data were collected in May, June, August in 2017, 2018, 2019, 2020, 2021

## Solute Concentrations

```{r}
# Load libraries
library(tidyverse)

# Load datafiles
Water_Chem <- read_csv("Datafiles/AB322_Water_Chemistry.csv")

# Arrange Month factor chronologically
Water_Chem$Month <- factor(Water_Chem$Month,levels = c("May", "June", "August"))
```


### Carbon
```{r}
# TOC, DOC, POC

P1 <- Water_Chem %>% 
  select(River, Month, DOC, TOC, POC) %>% 
  pivot_longer(cols= -c(River, Month), names_to = "Carbon", values_to= 'Concentration') %>% 
  ggplot(aes(x = Month, y = Concentration, color = Month)) + 
  geom_boxplot() +
  scale_color_manual(values=c("cornflowerblue","tan","lightsalmon4")) +
  facet_grid(Carbon~River, scales= "free") +
  ylab("Organic Carbon (umol/L)") + 
  xlab("River") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1), text = element_text(size=14))

P1
```

::: {.callout-tip}
Shortcut for the pipe (%>%): shift-command-m (mac); shift-control-m (windows)
:::

### Nutrients
```{r}
# NO3_NO2, SiO2, PO4

P2 <- Water_Chem %>% 
  select(River, Month, NO2_NO3, SiO2, PO4) %>% 
  pivot_longer(cols= -c(River, Month), names_to = "Nutrient", values_to= 'Concentration') %>% 
  ggplot(aes(x = Month, y = Concentration, color = Month)) + 
  geom_boxplot() +
  scale_color_manual(values=c("cornflowerblue","tan","lightsalmon4")) +
  facet_grid(Nutrient ~ River, scales = "free") +
  ylab("Concentration (umol/L)") + 
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1), text = element_text(size=14))

P2
```

### Contaminants 
```{r}
# Hg (Particulate and dissolved)

P3 <- Water_Chem %>% 
  select(River, Month, TotHg_Dissolved, TotHg_Particulate) %>% 
  pivot_longer(cols= -c(River, Month), names_to = "Mercury", values_to= 'Concentration') %>% 
  ggplot(aes(x = Month, y = Concentration, color = Month)) + 
  geom_boxplot() +
  scale_color_manual(values=c("cornflowerblue","tan","lightsalmon4")) +
  facet_grid(Mercury ~ River, scales = "free") +
  ylab("Concentration (ug/L)") + 
  xlab("River") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1), text = element_text(size=14))

P3
```
```{r}
#| eval: false
# Hg per gram Carbon

P4 <- Water_Chem %>% 
  select(River, Month, TotHg_g_DOC, TotHg_g_POC) %>% 
  pivot_longer(cols= -c(River, Month), names_to = "Mercury", values_to= 'Concentration') %>% 
  ggplot(aes(x = Month, y = Concentration, color = Month)) + 
  geom_boxplot() +
  scale_color_manual(values=c("cornflowerblue","tan","lightsalmon4")) +
  facet_grid(Mercury ~ River, scales = "free") +
  ylab("Concentration (mg/gC)") + 
  xlab("River") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1), text = element_text(size=14))

P4
```


::: {.callout-note caption="Fluxes"}
Fluxes, rather than concentration data are more relevant for evaluating implications on coastal ecosystems and the Arctic ocean. Fluxes are calculated using concentrations and discharge. 
:::

 




