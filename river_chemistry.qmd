# River water chemistry

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```


## Load libraries 
```{r}
# Packages for data preparation and plotting
library(tidyverse)
library(lubridate)
library(vegan)

# Packages for Spatial Analysis
library(sf)
library(terra)
library(units)
library(raster)
library(rgeos)
library(tmap)	
```

## Load datafiles

```{r}
# Load datafiles
water_chem <- read_csv("datafiles/AB322_Water_Chemistry.csv") %>% 
  mutate(Date = dmy(Date)) %>%
  mutate(year = year(Date),month = month(Date, label = TRUE), day = day(Date)) 

# Arrange month factor chronologically
water_chem$month <- factor(water_chem$month, levels = c("May", "Jun", "Aug", "Sep"))
```

## Data Preparation

::: {.callout-tip}
Shortcut for the pipe (%>%): shift-command-m (mac); shift-control-m (windows)
:::


## Explore water chemistry data

### Carbon
```{r}
# TOC, DOC, POC
P1 <- water_chem %>% 
  dplyr::select(River, month, DOC_mg_L) %>% 
  ggplot(aes(x = month, y = DOC_mg_L, color = month)) + 
  geom_point(size = 2, aes = 0.8) +
  scale_color_manual(values=c("cadetblue3", "cadetblue4", "darksalmon",  "plum4")) +
  facet_grid(~River, scales= "free") +
  ylab("DOC (mg C/L)") + 
  xlab("River") +
  theme_light() +
  scale_y_log10() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1), text = element_text(size=14))
P1
```

### Nutrients
```{r}
# NO3_NO2, SiO2, PO4

P2 <- water_chem %>% 
  dplyr::select(River, month, NO2_NO3_umol_L, SiO2_umol_L, PO4_umol_L) %>% drop_na() %>% 
  pivot_longer(cols= -c(River, month), names_to = "Nutrient", values_to= 'Concentration') %>% 
  ggplot(aes(x = month, y = Concentration, fill = month)) + 
  geom_point(size = 2, aes= 0.8) +
  scale_fill_manual(values=c("cadetblue3", "cadetblue4", "darksalmon",  "plum4")) +
  facet_grid(Nutrient ~ River, scales = "free") +
  ylab("Concentration (umol/L)") + 
  theme_light() +
  scale_y_log10() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1), text = element_text(size=14))

P2
```

### Contaminants 
```{r}
# Hg (Particulate and dissolved)

P3 <- water_chem %>% 
  dplyr::select(River, month, dTotHg_ng_L, pTotHg_ng_L) %>% drop_na() %>% 
  pivot_longer(cols= -c(River, month), names_to = "Mercury", values_to= 'Concentration') %>% 
  ggplot(aes(x = month, y = Concentration, fill = month)) + 
  geom_point(size = 2, aes = 0.8) +
  scale_fill_manual(values=c("cadetblue3", "cadetblue4", "darksalmon",  "plum4")) +
  facet_grid(Mercury ~ River, scales = "free") +
  ylab("Concentration (ug/L)") + 
  xlab("River") +
  theme_light() +
  scale_y_log10() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1), text = element_text(size=14))

P3
```




```{r}
#| eval: false
# Hg per gram Carbon

P4 <- water_chem %>% 
  dplyr::select(River, month, dTotHg_g_DOC, pTotHg_g_POC) %>% 
  pivot_longer(cols= -c(River, month), names_to = "Mercury", values_to= 'Concentration') %>% 
  ggplot(aes(x = month, y = Concentration, color = month)) + 
  geom_point(size = 2, aes= 0.8) +
  scale_color_manual(values=c("cadetblue3", "cadetblue4", "darksalmon",  "plum4")) +
  facet_grid(Mercury ~ River, scales = "free") +
  ylab("Concentration (mg/gC)") + 
  xlab("River") +
  theme_light() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1), text = element_text(size=14))

P4
```


::: {.callout-note caption="Fluxes"}
Fluxes, rather than concentration data are more relevant for evaluating implications on coastal ecosystems and the Arctic ocean. Fluxes are calculated using concentrations and discharge. 
:::

 




